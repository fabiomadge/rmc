<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Rust Model Checker</title>
                <meta name="robots" content="noindex" />
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Documentation for the Rust Model Checker (RMC)">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="getting-started.html"><strong aria-hidden="true">1.</strong> Getting started with RMC</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="install-guide.html"><strong aria-hidden="true">1.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="tool-comparison.html"><strong aria-hidden="true">1.2.</strong> Comparison with other tools</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.3.</strong> RMC on a single file</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.4.</strong> RMC on a crate</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.5.</strong> Debugging failures</div></li></ol></li><li class="chapter-item expanded "><a href="rmc-tutorial.html"><strong aria-hidden="true">2.</strong> RMC tutorial</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> RMC developer documentation</div></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">The Rust Model Checker</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/model-checking/rmc" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="getting-started-with-rmc"><a class="header" href="#getting-started-with-rmc">Getting started with RMC</a></h1>
<p>RMC is a Rust verification tool based on <em>model checking</em>.
With RMC, you can ensure that broad classes of problems are absent from your Rust code by writing <em>proof harnesses</em>, which are broadly similar to tests (especially property tests.)
RMC is especially useful for verifying unsafe code in Rust, where many of the language's usual guarantees can no longer be checked by the compiler.
But RMC is also useful for finding panics in safe Rust, and it can check user-defined assertions.</p>
<h2 id="project-status"><a class="header" href="#project-status">Project Status</a></h2>
<p>RMC is currently in the initial development phase, and has not yet made an official release.
It is under active development, but it does not yet support all Rust language features.
If you encounter issues when using RMC we encourage you to <a href="https://github.com/model-checking/rmc/issues/new/choose">report them to us</a>.</p>
<h2 id="getting-started"><a class="header" href="#getting-started">Getting started</a></h2>
<ol>
<li><a href="./install-guide.html">Begin with the RMC installation guide.</a> Currently, this means checking out and building RMC.</li>
<li><a href="./tool-comparison.html">Understand how RMC compares to other potential tools for verifying Rust code.</a></li>
<li><a href="./rmc-tutorial.html">Try following the RMC tutorial to get a feel for how RMC can be applied.</a></li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rmc-installation-guide"><a class="header" href="#rmc-installation-guide">RMC Installation Guide</a></h1>
<p>RMC must currently be built from source.</p>
<p>In general, the following dependencies are required:</p>
<ol>
<li>The dependencies needed to built <code>rustc</code>. RMC is a fork of the Rust compiler, and so we have the same minimum requirements.</li>
<li><a href="https://github.com/diffblue/cbmc">CBMC</a> (&gt;= 5.30.1)</li>
<li><a href="https://github.com/awslabs/aws-viewer-for-cbmc">CBMC Viewer</a> (&gt;= 2.6)</li>
</ol>
<h2 id="installing-on-ubuntu-2004"><a class="header" href="#installing-on-ubuntu-2004">Installing on Ubuntu 20.04</a></h2>
<p>The simplest way to install (especially if you're using a fresh VM) is following our CI scripts:</p>
<pre><code># git clone git@github.com:model-checking/rmc.git
git clone https://github.com/model-checking/rmc.git
cd rmc
git submodule update --init
./scripts/setup/ubuntu-20.04/install_deps.sh
./scripts/setup/ubuntu-20.04/install_cbmc.sh
./scripts/setup/install_viewer.sh 2.6
./scripts/setup/install_rustup.sh
</code></pre>
<h2 id="installing-on-mac-os"><a class="header" href="#installing-on-mac-os">Installing on Mac OS</a></h2>
<p>You need to have <a href="https://brew.sh/">Homebrew</a> installed already.</p>
<pre><code># git clone git@github.com:model-checking/rmc.git
git clone https://github.com/model-checking/rmc.git
cd rmc
git submodule update --init
./scripts/setup/macos-10.15/install_deps.sh
./scripts/setup/macos-10.15/install_cbmc.sh
./scripts/setup/install_viewer.sh 2.6
./scripts/setup/install_rustup.sh
</code></pre>
<h2 id="building-and-testing-rmc"><a class="header" href="#building-and-testing-rmc">Building and testing RMC</a></h2>
<p>Perform one-time build configuration:</p>
<pre><code>./configure \
    --enable-debug \
    --set=llvm.download-ci-llvm=true \
    --set=rust.debug-assertions-std=false \
    --set=rust.deny-warnings=false
</code></pre>
<p><strong>NOTE: If you skip the above (<code>llvm.download-ci-llvm=true</code> specifically), builds may take a long time as all of LLVM would need to be built from scratch.</strong></p>
<p>Then build RMC:</p>
<pre><code>./x.py build -i --stage 1 library/std
</code></pre>
<p>Then, optionally, run the regression tests:</p>
<pre><code>./scripts/rmc-regression.sh
</code></pre>
<p>This script has a lot of noisy output, but on a successful run you will see:</p>
<pre><code>All RMC regression tests completed successfully.
</code></pre>
<h2 id="try-running-rmc"><a class="header" href="#try-running-rmc">Try running RMC</a></h2>
<p>Get the RMC script in your path:</p>
<pre><code class="language-bash">export PATH=$(pwd)/scripts:$PATH
</code></pre>
<p>Create a test file:</p>
<pre><pre class="playground"><code class="language-rust">// File: test.rs
fn main() {
    assert!(1 == 2);
}
</code></pre></pre>
<p>Run RMC on the single file:</p>
<pre><code>rmc test.rs
</code></pre>
<p>You should get a result like this one:</p>
<pre><code>[snipped output]
** Results:
test.rs function main
[main.assertion.1] line 2 assertion failed: 1 == 2: FAILURE

** 1 of 1 failed (2 iterations)
VERIFICATION FAILED
</code></pre>
<p>Fix the test and you should see <code>rmc</code> succeed.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="comparison-with-other-tools"><a class="header" href="#comparison-with-other-tools">Comparison with other tools</a></h1>
<p><strong>Fuzzing</strong> (for example, with <a href="https://github.com/rust-fuzz/cargo-fuzz"><code>cargo-fuzz</code></a>) is a unguided approach to random testing.
A fuzzer generally provides an input of random bytes, and then examines fairly generic properties (&quot;doesn't crash or commit undefined behavior&quot;) about the behavior of the resulting program.
Fuzzers generally get their power through a kind of evolutionary algorithm that rewards new mutant inputs that &quot;discover&quot; new branches of the program under test.
Fuzzers are excellent for testing security boundaries, precisely because they make no validity assumptions (hence &quot;unguided&quot;) when generating the input.</p>
<p><strong>Property testing</strong> (for example, with <a href="https://github.com/AltSysrq/proptest"><code>proptest</code></a>) is a guided approach to random testing.
&quot;Guided&quot; in the sense that the test generally provides a strategy (for generating random values) that constrains their range.
The purpose of this is to either focus on interesting values, or because the assertions in the test will only hold for a constrained set of inputs.
This generator is sampled several times, and the test's assertions are checked for each sample.
Tests in this style do actually state properties: &quot;forall inputs (of some constrained kind), this condition should hold.&quot;
Property testing is often quite effective, but the engine can't fully prove the property, it can only sample randomly a few of those values to test (though property testing libraries frequently give interesting &quot;edge cases&quot; higher probability, making them more effective at bug-finding).</p>
<p><strong>Model checking</strong> is similar to these techniques in how you use them, but model checking is non-random and exhaustive (though often only up to some bound on input or problem size).
Thus, properties checked with a model checker are effectively proofs.
Instead of naively trying all possible <em>concrete</em> inputs (which could be infeasible and blow up exponentially), model checkers like RMC will cleverly encode program traces as <em>symbolic</em> &quot;<a href="https://en.wikipedia.org/wiki/Boolean_satisfiability_problem">SAT</a>/<a href="https://en.wikipedia.org/wiki/Satisfiability_modulo_theories">SMT</a>&quot; problems, and hand them off to SAT/SMT solvers.
Again, SAT/SMT solving is an <a href="https://en.wikipedia.org/wiki/NP-completeness">NP-complete</a> problem, but most practical programs can be model checked within milliseconds to seconds (with notable exceptions: you can easily try to reverse a cryptographic hash with a model checker, but good luck getting it to terminate!)</p>
<p>Model checking allows you to prove non-trivial properties about programs, and check those proofs in roughly the same amount of time as a traditional test suite would take to run.
The downside is many types of properties can quickly become &quot;too large&quot; to practically model check, and so writing &quot;proof harnesses&quot; (very similar to property tests and fuzzer harnesses) requires some skill to understand why the solver is not terminating and fix the structure of the problem you're giving it so that it does.
This process basically boils down to &quot;debugging&quot; the proof.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rmc-tutorial"><a class="header" href="#rmc-tutorial">RMC tutorial</a></h1>
<p>If you're interested in applying RMC, then you're probably in this situation:</p>
<ol>
<li>You're working on a moderately important project in Rust.</li>
<li>You've already invested heavily in testing to ensure correctness, and possibly fuzzing to ensure the absence of shallow security issues.</li>
<li>You want to invest further, to gain a much higher degree of assurance.</li>
</ol>
<blockquote>
<p>If you haven't already, we recommend techniques like property testing (e.g. with <a href="https://github.com/AltSysrq/proptest"><code>proptest</code></a>) before attempting model checking.
These yield good results, are very cheap to apply, and are often easier to adopt and debug.
Refactoring work to make your code more property-testable will generally also make the code more model-checkable as well.
RMC is a next step: a tool that can be applied once cheaper tactics are no longer yielding results, or once the easier to detect issues have already been dealt with.</p>
</blockquote>
<p>This tutorial will step you through a progression from simple to moderately complex tasks with RMC.
It's meant to ensure you can get started, and see at least some simple examples of how typical proofs are structured.
It will also teach you the basics of &quot;debugging&quot; proof harnesses, which mainly consists of diagnosing and resolving non-termination issues with the solver.</p>
<ol>
<li><a href="./install-guide.html">Begin with RMC installation.</a> This will take through to running <code>rmc</code> on your first Rust program.</li>
<li>Consider reading our <a href="./tool-comparison.html">tool comparison</a> to understand what RMC is.</li>
<li>Coming soon: the tutorial.</li>
<li>Consider returning to the <a href="./tool-comparison.html">tool comparison</a> after trying the tutorial to see if any of the abstract ideas have become more concrete.</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
                        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
                
    </body>
</html>
